<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maine Lobster Dealer Tycoon</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Welcome Screen - Atmospheric Dawn Scene -->
    <div id="welcome-screen" class="welcome-screen">
        <!-- Atmospheric Hero Background -->
        <div class="welcome-hero">
            <div class="hero-sky"></div>
            <div class="hero-sun"></div>
            <div class="hero-ocean"></div>
            <div class="hero-dock-silhouette"></div>
            <div class="hero-lighthouse"></div>
            <div class="hero-lobster-silhouette">ü¶û</div>
        </div>
        <!-- Content Overlay -->
        <div class="welcome-content">
            <h1 class="welcome-title">Maine Lobster<br>Dealer Tycoon</h1>
            <button id="start-game-btn" class="btn-ceremony">Begin Your Run</button>
        </div>
    </div>

    <!-- Opening Story Screen -->
    <div id="story-screen" class="story-screen" style="display: none;">
        <div class="story-content">
            <div class="story-icon">ü¶û</div>
            <p class="story-text">
                You've put <strong>$5,000</strong> of your own savings on the line,
                secured a spot on the <strong>Stonington fish pier</strong>,
                and bet everything on making it as a lobster dealer.
            </p>
            <p class="story-subtext">Every day is a risk. Make it count.</p>
            <button id="story-continue-btn" class="btn-ceremony">Start Day 1</button>
            <button id="story-how-to-play-btn" class="btn-secondary-ceremony">How to Play</button>
        </div>
    </div>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" class="tutorial-overlay" style="display: none;">
        <div class="tutorial-backdrop"></div>
        <div class="tutorial-box" id="tutorial-box">
            <div class="tutorial-header">
                <span class="tutorial-step" id="tutorial-step">1/8</span>
                <h3 id="tutorial-title">Welcome!</h3>
            </div>
            <p class="tutorial-message" id="tutorial-message">Tutorial message here</p>
            <div class="tutorial-buttons">
                <button id="tutorial-skip" class="btn btn-small">Skip Tutorial</button>
                <button id="tutorial-next" class="btn btn-primary">Next</button>
            </div>
        </div>
        <div class="tutorial-highlight" id="tutorial-highlight"></div>
    </div>

    <div class="game-container">
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             STATUS STRIP - Always visible at top
             ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <header class="status-strip">
            <!-- Left: Identity + Badge -->
            <div class="strip-identity">
                <button class="badge-btn" id="badge-icon" title="View License">
                    <span class="badge-visual" id="badge-visual">üìã</span>
                </button>
                <div class="identity-text">
                    <span class="strip-title">Lobster Tycoon</span>
                    <span class="strip-reputation" id="strip-reputation">Dock Nobody</span>
                </div>
            </div>

            <!-- Center: Survival State -->
            <div class="strip-survival">
                <div class="strip-stat strip-cash">
                    <span class="stat-value" id="cash">$5,000</span>
                </div>
                <div class="strip-stat">
                    <span class="stat-label">Stock</span>
                    <span class="stat-value"><span id="inventory-total">0</span>/<span id="capacity">500</span></span>
                </div>
                <div class="strip-stat">
                    <span class="stat-label">Fresh</span>
                    <span class="stat-value" id="avg-freshness">100%</span>
                </div>
            </div>

            <!-- Right: Pressure -->
            <div class="strip-pressure">
                <div class="strip-stat strip-day">
                    <span class="stat-label">Day</span>
                    <span class="stat-value"><span id="day">1</span>/30</span>
                </div>
                <div class="strip-stat strip-weather">
                    <span id="weather-icon">‚òÄÔ∏è</span>
                    <span class="weather-next">‚Üí<span id="tomorrow-weather">‚òÄÔ∏è</span></span>
                </div>
                <div class="strip-stat strip-market">
                    <span id="market-trend" class="trend-stable">Stable</span>
                </div>
            </div>

            <!-- Quick Actions - Desktop shows all, mobile shows overflow menu -->
            <div class="strip-actions strip-actions-desktop">
                <button id="shop-btn" class="strip-btn" title="Shop">üõí</button>
                <button id="bank-btn" class="strip-btn" title="Bank">üè¶</button>
                <button id="stats-btn" class="strip-btn" title="Stats">üìä</button>
                <button id="help-btn" class="strip-btn" title="How to Play">‚ùì</button>
            </div>
            <!-- Mobile overflow menu -->
            <div class="strip-actions-mobile">
                <button id="more-menu-btn" class="strip-btn more-btn" title="More">‚ãØ</button>
                <div class="more-menu" id="more-menu">
                    <button id="shop-btn-mobile" class="more-menu-item">üõí Shop</button>
                    <button id="bank-btn-mobile" class="more-menu-item">üè¶ Bank</button>
                    <button id="stats-btn-mobile" class="more-menu-item">üìä Stats</button>
                    <button id="help-btn-mobile" class="more-menu-item">‚ùì How to Play</button>
                </div>
            </div>
        </header>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             WORKSPACE NAVIGATION - Tab bar
             ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <nav class="workspace-nav">
            <button id="tab-dock" class="nav-tab active" data-view="dock">
                <span class="tab-icon">‚öì</span>
                <span class="tab-label">Dock</span>
            </button>
            <button id="tab-tanks" class="nav-tab" data-view="tanks">
                <span class="tab-icon">ü¶û</span>
                <span class="tab-label">Tanks</span>
            </button>
            <button id="tab-buyers" class="nav-tab" data-view="buyers">
                <span class="tab-icon">üí∞</span>
                <span class="tab-label">Buyers</span>
            </button>
            <button id="tab-travel" class="nav-tab" data-view="travel">
                <span class="tab-icon">üó∫Ô∏è</span>
                <span class="tab-label">Travel</span>
            </button>
        </nav>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             MAIN WORKSPACE - Single focused panel at a time
             ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <main class="workspace">
            <!-- Animated Scene Overlay -->
            <div class="scene-overlay" id="scene-overlay">
                <div class="weather-effects" id="weather-effects"></div>
                <div class="boat-arrival" id="boat-arrival">
                    <div class="arrival-boat">üö§</div>
                    <div class="arrival-wake"></div>
                </div>
                <div class="truck-travel" id="truck-travel">
                    <div class="travel-truck">üöö</div>
                    <div class="travel-road"></div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                 DOCK VIEW - Buying from boats
                 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section class="workspace-panel" id="dock-view">
                <div class="panel-header">
                    <h2><span id="location-emoji">üé£</span> <span id="location-name">Stonington</span> Dock</h2>
                    <div class="location-prices">
                        <span class="price-tag buy">Buy <span id="buy-mod">-20%</span></span>
                        <span class="price-tag sell">Sell <span id="sell-mod">-15%</span></span>
                    </div>
                </div>

                <div id="boats-container" class="boats-container">
                    <!-- Empty state -->
                    <div class="empty-state" id="dock-empty">
                        <p class="empty-message">No boats at the dock yet...</p>
                        <p class="empty-context" id="dock-empty-context">The morning fog is still lifting...</p>
                        <div class="empty-actions" id="dock-primary-actions">
                            <button class="btn btn-secondary" data-action="switch-buyers">Check Buyers</button>
                            <button class="btn btn-secondary" data-action="switch-travel">Travel to Another Port</button>
                        </div>
                    </div>
                    <!-- Boats populated by JS -->
                </div>

                <!-- Ambient pressure indicator -->
                <div class="dock-ambient" id="dock-ambient">
                    <span class="ambient-time" id="dock-time-of-day">Morning</span>
                    <span class="ambient-pressure" id="dock-pressure-hint">Freshness is holding... for now.</span>
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                 TANKS VIEW - Inventory risk management
                 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section class="workspace-panel hidden" id="tanks-view">
                <div class="tanks-container">

                    <!-- TankHero - Visual tank display -->
                    <div class="tank-hero" id="tank-hero">
                        <div class="tank-vessel">
                            <div class="tank-glass">
                                <div class="tank-water" id="tank-water">
                                    <div class="water-surface"></div>
                                    <div class="tank-lobsters" id="tank-lobsters">
                                        <!-- Lobster icons populated by JS -->
                                    </div>
                                </div>
                            </div>
                            <div class="tank-frame"></div>
                            <div class="tank-base"></div>
                        </div>
                        <div class="tank-gauge">
                            <div class="gauge-marks">
                                <span class="mark" style="bottom: 100%">Full</span>
                                <span class="mark" style="bottom: 50%">50%</span>
                                <span class="mark" style="bottom: 0%">Empty</span>
                            </div>
                        </div>
                    </div>

                    <!-- TankSummaryRow -->
                    <div class="tank-summary-row">
                        <div class="summary-stat">
                            <span class="stat-value"><span id="tank-current">0</span>/<span id="tank-max">500</span></span>
                            <span class="stat-label">lbs</span>
                        </div>
                        <div class="summary-stat">
                            <span class="stat-value" id="tank-freshness">100%</span>
                            <span class="stat-label">Fresh</span>
                        </div>
                        <div class="summary-stat">
                            <span class="stat-value capacity-label" id="tank-capacity-label">Empty</span>
                            <span class="stat-label">Status</span>
                        </div>
                    </div>

                    <!-- RiskForecastCard -->
                    <div class="risk-forecast-card" id="risk-card">
                        <div class="risk-header">
                            <span class="risk-icon">‚ö†Ô∏è</span>
                            <h3>Tomorrow's Risk</h3>
                            <span class="risk-trend" id="risk-trend">Stable</span>
                        </div>
                        <div class="risk-stats">
                            <div class="risk-stat">
                                <span class="risk-label">Expected Loss</span>
                                <span class="risk-value" id="tank-loss-estimate">0-2 lbs</span>
                            </div>
                            <div class="risk-stat risk-dollars">
                                <span class="risk-label">Dollar Impact</span>
                                <span class="risk-value danger" id="tank-loss-dollars">~$0</span>
                            </div>
                        </div>
                        <!-- Do Nothing Preview -->
                        <div class="do-nothing-preview">
                            <p class="preview-title">If you end the day without selling:</p>
                            <div class="preview-stats">
                                <span>Tomorrow's freshness: <strong id="projected-freshness">95%</strong></span>
                                <span>Spoilage risk: <strong id="projected-risk">Low</strong></span>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Breakdown (collapsible) -->
                    <details class="inventory-details">
                        <summary>Inventory Breakdown</summary>
                        <div class="inventory-grid" id="inventory-breakdown">
                            <div class="inventory-card grade-select">
                                <span class="grade-name">Select (2+ lb)</span>
                                <span class="grade-amount" id="inventory-a">0 lbs</span>
                            </div>
                            <div class="inventory-card grade-quarter">
                                <span class="grade-name">Quarter (1.25-2 lb)</span>
                                <span class="grade-amount" id="inventory-b">0 lbs</span>
                            </div>
                            <div class="inventory-card grade-chix">
                                <span class="grade-name">Chix (1-1.25 lb)</span>
                                <span class="grade-amount" id="inventory-c">0 lbs</span>
                            </div>
                            <div class="inventory-card grade-run" id="run-card">
                                <span class="grade-name">Run (Ungraded)</span>
                                <span class="grade-amount" id="inventory-run">0 lbs</span>
                            </div>
                        </div>
                    </details>

                    <!-- DecisionPanel -->
                    <div class="decision-panel">
                        <p class="decision-prompt">Hold for better prices and risk spoilage, or sell now and lock in today's margin.</p>

                        <div class="decision-options">
                            <div class="decision-option decision-sell">
                                <button class="btn btn-primary btn-large" data-action="switch-buyers">Sell Now</button>
                                <p class="decision-consequence" id="sell-consequence">Est. revenue: <strong>$0</strong></p>
                            </div>

                            <div class="decision-option decision-hunt">
                                <button class="btn btn-secondary btn-large" data-action="switch-travel">Find Better Prices</button>
                                <p class="decision-consequence">Travel costs + spoilage risk</p>
                            </div>
                        </div>
                    </div>

                    <!-- Tank Warning (hidden by default) -->
                    <div class="tank-warning hidden" id="tank-warning">
                        <span class="warning-icon">üö®</span>
                        <span class="warning-text">Tank over 80% - sell soon to avoid spoilage!</span>
                    </div>

                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                 BUYERS VIEW - Selling decisions
                 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section class="workspace-panel hidden" id="buyers-view">
                <div class="panel-header">
                    <h2>Buyers at <span id="buyers-location">Stonington</span></h2>
                </div>

                <div id="buyers-list" class="buyers-container">
                    <!-- Empty state -->
                    <div class="empty-state" id="buyers-empty">
                        <p class="empty-message">No buyers available right now...</p>
                        <div class="empty-actions">
                            <button class="btn btn-secondary" data-action="switch-dock">Check the Dock</button>
                            <button class="btn btn-secondary" data-action="switch-travel">Travel to Find Buyers</button>
                        </div>
                    </div>
                    <!-- Buyers populated by JS -->
                </div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                 TRAVEL VIEW - Coastal Map + Port selection
                 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section class="workspace-panel hidden" id="travel-view">
                <div class="panel-header">
                    <h2>Maine Coast</h2>
                    <div class="current-port-badge">
                        <span class="port-label">üìç</span>
                        <span class="port-name" id="current-port-name">Stonington</span>
                    </div>
                </div>

                <div class="travel-container">
                    <!-- Coastal Map -->
                    <div class="coastal-map" id="travel-map">
                        <div class="map-background">
                            <div class="map-ocean"></div>
                            <div class="map-compass"></div>
                            <!-- Maine outline from Natural Earth GeoJSON (public domain) -->
                            <svg class="map-land-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <defs>
                                    <!-- Drop shadow for depth -->
                                    <filter id="land-shadow" x="-20%" y="-20%" width="140%" height="140%">
                                        <feDropShadow dx="-2" dy="2" stdDeviation="1" flood-color="#000" flood-opacity="0.4"/>
                                    </filter>

                                    <!-- Topographic texture pattern -->
                                    <pattern id="land-texture" patternUnits="userSpaceOnUse" width="20" height="20">
                                        <rect width="20" height="20" fill="transparent"/>
                                        <circle cx="10" cy="10" r="0.5" fill="rgba(255,255,255,0.03)"/>
                                        <circle cx="5" cy="5" r="0.3" fill="rgba(0,0,0,0.02)"/>
                                        <circle cx="15" cy="3" r="0.4" fill="rgba(255,255,255,0.02)"/>
                                        <circle cx="3" cy="15" r="0.3" fill="rgba(0,0,0,0.03)"/>
                                    </pattern>

                                    <!-- Composite texture fill -->
                                    <linearGradient id="land-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#3a5a48"/>
                                        <stop offset="50%" stop-color="#2d4a3a"/>
                                        <stop offset="100%" stop-color="#243d30"/>
                                    </linearGradient>
                                </defs>
                                <!-- Base land with gradient -->
                                <path class="maine-land" filter="url(#land-shadow)" d="
                                    M 9.2,100 L 6.3,98.4 L 6.7,96.2 L 2.8,93.5 L 1.2,63.7 L 0,49.1
                                    L 10.5,46 L 8.8,44.4 L 12.8,40.8 L 17,39.2 L 16.2,37.9 L 20,35.7
                                    L 18.8,31.8 L 21.2,25.7 L 25,23.7 L 26.4,17.4 L 45.3,0 L 49.7,0.7
                                    L 50,5 L 53.2,6.4 L 61,4 L 66,4 L 69.5,2.3 L 76.3,6
                                    L 80.3,9 L 80.5,34.5 L 80,40.7 L 88.4,42.2 L 87.2,44.9 L 89.4,47.4
                                    L 87.6,49.6 L 91.7,52.8 L 95.6,52.6 L 100,60.4 L 94.9,63.9 L 92,62.6
                                    L 89.6,65.1 L 86.1,64.5 L 85.7,66.5 L 81.2,66.4 L 74,71.1 L 72.2,67.8
                                    L 69.7,67.6 L 70.9,71.1 L 65.3,72 L 64,69.2 L 61.3,70.6 L 55,70.6
                                    L 54.9,67.3 L 51.1,68.1 L 51.8,70.4 L 48.3,75.3 L 49,76.7 L 44.5,79.4
                                    L 39.9,78.5 L 37.2,81.3 L 33.5,81.7 L 30.4,84.1 L 26.7,83.6 L 25.6,81.1
                                    L 20.2,85 L 21.6,87.6 L 17.6,88.4 L 17.4,90.6 L 12.8,92.9 Z"/>
                                <!-- Texture overlay -->
                                <path class="maine-land-texture" d="
                                    M 9.2,100 L 6.3,98.4 L 6.7,96.2 L 2.8,93.5 L 1.2,63.7 L 0,49.1
                                    L 10.5,46 L 8.8,44.4 L 12.8,40.8 L 17,39.2 L 16.2,37.9 L 20,35.7
                                    L 18.8,31.8 L 21.2,25.7 L 25,23.7 L 26.4,17.4 L 45.3,0 L 49.7,0.7
                                    L 50,5 L 53.2,6.4 L 61,4 L 66,4 L 69.5,2.3 L 76.3,6
                                    L 80.3,9 L 80.5,34.5 L 80,40.7 L 88.4,42.2 L 87.2,44.9 L 89.4,47.4
                                    L 87.6,49.6 L 91.7,52.8 L 95.6,52.6 L 100,60.4 L 94.9,63.9 L 92,62.6
                                    L 89.6,65.1 L 86.1,64.5 L 85.7,66.5 L 81.2,66.4 L 74,71.1 L 72.2,67.8
                                    L 69.7,67.6 L 70.9,71.1 L 65.3,72 L 64,69.2 L 61.3,70.6 L 55,70.6
                                    L 54.9,67.3 L 51.1,68.1 L 51.8,70.4 L 48.3,75.3 L 49,76.7 L 44.5,79.4
                                    L 39.9,78.5 L 37.2,81.3 L 33.5,81.7 L 30.4,84.1 L 26.7,83.6 L 25.6,81.1
                                    L 20.2,85 L 21.6,87.6 L 17.6,88.4 L 17.4,90.6 L 12.8,92.9 Z"/>
                            </svg>
                        </div>
                        <!-- Route lines between ports -->
                        <svg class="map-routes" id="map-routes"></svg>
                        <div class="map-ports" id="map-ports">
                            <!-- Port nodes populated by JS -->
                        </div>
                    </div>

                    <!-- Port Details Panel -->
                    <div class="port-details" id="travel-details">
                        <div class="details-placeholder">
                            <p>Select a port on the map to see details</p>
                        </div>
                        <div class="details-content" id="details-content" style="display: none;">
                            <div class="details-header">
                                <span class="details-emoji" id="details-emoji">üé£</span>
                                <span class="details-name" id="details-name">Stonington</span>
                            </div>
                            <div class="details-mods">
                                <div class="details-mod">
                                    <span class="mod-label">Buy:</span>
                                    <span class="mod-value" id="details-buy">Very Cheap</span>
                                </div>
                                <div class="details-mod">
                                    <span class="mod-label">Sell:</span>
                                    <span class="mod-value" id="details-sell">Below Avg</span>
                                </div>
                            </div>
                            <p class="details-desc" id="details-desc">Remote fishing village - cheapest lobster</p>
                            <div class="details-lock" id="details-lock" style="display: none;">
                                <span class="lock-tier" id="details-lock-tier">üîí Local Regular</span>
                                <span class="lock-reason" id="details-lock-reason">They don't deal with strangers.</span>
                            </div>
                            <button class="btn btn-primary btn-large" id="travel-confirm-button" disabled>
                                Travel - $<span id="details-cost">0</span>
                            </button>
                        </div>
                    </div>

                    <!-- Fallback Port List (collapsible) -->
                    <details class="port-list-fallback">
                        <summary>Port List</summary>
                        <div class="ports-list" id="travel-port-list">
                            <!-- Ports populated by JS -->
                        </div>
                    </details>

                    <!-- Travel Requirement (shown when no van) -->
                    <div class="travel-requirement" id="travel-requirement">
                        <span class="lock-icon">üöö</span>
                        <span class="requirement-text">Buy a Delivery Van from the Shop to travel between ports</span>
                    </div>
                </div>
            </section>
        </main>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             ACTION BAR - End Day button (SINGLE SOURCE OF TRUTH)
             ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="action-bar" id="action-bar">
            <button id="end-day-button" class="btn btn-large btn-ceremony">End Day</button>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             GAME LOG - Collapsible
             ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <details class="log-panel">
            <summary>Activity Log</summary>
            <div id="game-log">
                <p>Welcome to Maine! Build your lobster empire!</p>
            </div>
        </details>

        <!-- Shop Modal -->
        <div id="shop-modal" class="modal" style="display: none;">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h2>Equipment Shop</h2>
                    <button id="close-shop-btn" class="btn btn-small">X</button>
                </div>
                <div id="equipment-list" class="equipment-list">
                    <!-- Equipment items populated by JS -->
                </div>
            </div>
        </div>

        <!-- Bank Modal -->
        <div id="bank-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>First Maine Bank</h2>
                    <button id="close-bank-btn" class="btn btn-small">X</button>
                </div>
                <div class="bank-info">
                    <p>Cash: $<span id="bank-cash">0</span></p>
                    <p>Current Debt: $<span id="bank-debt">0</span></p>
                    <p>Max Loan: $<span id="max-loan">0</span></p>
                    <p>Interest: <span id="interest-rate">5</span>% per week</p>
                </div>
                <div class="bank-actions">
                    <div class="bank-row">
                        <input type="number" id="loan-amount" placeholder="Amount" value="5000">
                        <button id="loan-btn" class="btn btn-primary">Take Loan</button>
                    </div>
                    <div class="bank-row">
                        <input type="number" id="pay-amount" placeholder="Amount">
                        <button id="pay-btn" class="btn btn-primary">Pay Debt</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Modal -->
        <div id="stats-modal" class="modal" style="display: none;">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h2>Business Statistics</h2>
                    <button id="close-stats-btn" class="btn btn-small">X</button>
                </div>
                <div class="stats-content">
                    <div class="stats-section">
                        <h3>Trading</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Lobsters Bought</span>
                                <span class="stat-value" id="stat-bought">0 lbs</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Lobsters Sold</span>
                                <span class="stat-value" id="stat-sold">0 lbs</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Money Earned</span>
                                <span class="stat-value" id="stat-earned">$0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Money Spent</span>
                                <span class="stat-value" id="stat-spent">$0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total Profit</span>
                                <span class="stat-value positive" id="stat-profit">$0</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-section">
                        <h3>Records</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Best Day Profit</span>
                                <span class="stat-value positive" id="stat-best-day">$0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Worst Day Loss</span>
                                <span class="stat-value negative" id="stat-worst-day">$0</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-section">
                        <h3>Relationships</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Favorite Captain</span>
                                <span class="stat-value" id="stat-fav-captain">None yet</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Best Buyer</span>
                                <span class="stat-value" id="stat-best-buyer">None yet</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-section">
                        <h3>Competition</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label">Rivals Outbid</span>
                                <span class="stat-value positive" id="stat-rivals-beat">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Lost to Rivals</span>
                                <span class="stat-value negative" id="stat-rivals-lost">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-section retirement-section" id="retirement-section" style="display: none;">
                        <h3>Retirement Options</h3>
                        <p class="retirement-intro">Cash out and start a new game with prestige bonuses!</p>
                        <div class="retirement-options" id="retirement-options">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                    <div class="stats-footer">
                        <button id="replay-tutorial-btn" class="btn btn-small">Replay Tutorial</button>
                        <button id="how-to-play-btn" class="btn btn-small">How to Play</button>
                    </div>
                    <div class="stats-credit">
                        <p>A tycoon game by Derek</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- How to Play Modal -->
        <div id="how-to-play-modal" class="modal" style="display: none;">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h2>How to Play</h2>
                    <button id="close-how-to-play-btn" class="btn btn-small">X</button>
                </div>
                <div class="how-to-play-content">
                    <div class="guide-section">
                        <h3>üéØ What You're Trying to Do</h3>
                        <p>You start with $5,000, a spot on the Stonington pier, and no reputation.</p>
                        <ul class="guide-list">
                            <li>Grow your cash over 30 summer days</li>
                            <li>Buy smart, manage risk, earn trust</li>
                        </ul>
                        <p class="guide-tiers-compact">
                            ‚≠ê $10K ¬∑ ‚≠ê‚≠ê $25K ¬∑ ‚≠ê‚≠ê‚≠ê $50K ¬∑ ‚≠ê‚≠ê‚≠ê‚≠ê $100K
                        </p>
                    </div>
                    <div class="guide-section">
                        <h3>ü¶û How You Make Money</h3>
                        <ul class="guide-list">
                            <li><strong>Buy</strong> lobsters from boats at the dock</li>
                            <li><strong>Sell</strong> to restaurants, tourists, wholesalers</li>
                            <li><strong>End Day</strong> to advance ‚Äî new boats and buyers arrive</li>
                        </ul>
                        <p>Sell before freshness drops. Don't hold too long!</p>
                    </div>
                    <div class="guide-section">
                        <h3>üí° The Real Secret</h3>
                        <ul class="guide-list">
                            <li><strong>Fishing villages</strong> (Stonington) ‚Üí cheap lobster</li>
                            <li><strong>Tourist towns</strong> (Bar Harbor) ‚Üí premium prices</li>
                        </ul>
                        <p>Buy low, travel, sell high. That's the game.</p>
                    </div>
                    <div class="guide-section">
                        <h3>üöö Travel</h3>
                        <p>Get a <strong>Delivery Van</strong> ($2,000 from Shop) to travel. It's your first big investment.</p>
                    </div>
                    <div class="guide-section">
                        <h3>üìä Lobster Grades</h3>
                        <ul class="guide-list">
                            <li><strong>Selects</strong> ‚Äî 2+ lbs, highest price, slower to sell</li>
                            <li><strong>Quarters</strong> ‚Äî 1.25-2 lbs, reliable value</li>
                            <li><strong>Chix</strong> ‚Äî 1-1.25 lbs, cheaper, easier to move</li>
                            <li><strong>Run</strong> ‚Äî Mixed sizes, lowest price, fast turnover</li>
                        </ul>
                    </div>
                    <div class="guide-section">
                        <h3>‚≠ê Reputation</h3>
                        <p>Trade fairly to build trust. Higher rep unlocks:</p>
                        <ul class="guide-list">
                            <li>Better prices from loyal captains</li>
                            <li>Access to premium ports</li>
                            <li>Special buyers</li>
                        </ul>
                    </div>
                    <div class="guide-section">
                        <h3>‚ö†Ô∏è Watch Out For</h3>
                        <ul class="guide-list">
                            <li>Lobsters lose value over time</li>
                            <li>Tanks have limited capacity</li>
                            <li>Bad weather reduces supply</li>
                            <li>Rivals take boats if you wait too long</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Modal -->
        <div id="map-modal" class="modal" style="display: none;">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h2>Maine Coast Map</h2>
                    <button id="close-map-btn" class="btn btn-small">X</button>
                </div>
                <div class="map-container">
                    <div class="map-visual" id="map-visual">
                        <!-- Map background and town markers rendered by JS -->
                        <div class="map-coastline"></div>
                    </div>
                    <div class="map-legend">
                        <h3>Towns</h3>
                        <div id="town-list" class="town-list">
                            <!-- Town list populated by JS -->
                        </div>
                        <div class="travel-info" id="travel-info">
                            <p class="travel-requirement">Requires: Delivery Van</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Badge/License Modal -->
        <div id="badge-modal" class="modal" style="display: none;">
            <div class="modal-content badge-content">
                <button id="close-badge-btn" class="modal-close-btn">‚úï</button>
                <div class="badge-display">
                    <div class="badge-artwork" id="badge-artwork">
                        <div class="badge-frame badge-paper">
                            <span class="badge-emblem">üìã</span>
                        </div>
                    </div>
                    <h2 class="badge-tier-title" id="badge-tier-title">Dock Nobody</h2>
                    <p class="badge-flavor" id="badge-flavor">Temporary license. Nobody knows your name.</p>
                </div>
                <div class="badge-progress">
                    <h3>Reputation Progress</h3>
                    <div class="rep-bar">
                        <div class="rep-fill" id="badge-rep-fill" style="width: 0%"></div>
                    </div>
                    <p class="rep-next" id="badge-rep-next">Next: Local Regular</p>
                </div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="game-over-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2 id="game-over-title">Game Over</h2>
                <p id="game-over-message"></p>
                <button id="restart-btn" class="btn btn-primary">Play Again</button>
            </div>
        </div>

        <!-- Day Summary Modal -->
        <div id="day-summary-modal" class="modal modal-fullscreen" style="display: none;">
            <div class="modal-content day-summary">
                <h2>Day <span id="summary-day">1</span> Complete</h2>
                <div class="summary-verdict" id="summary-verdict"></div>

                <!-- What You Achieved -->
                <div class="summary-section summary-achieved">
                    <h3>What You Achieved</h3>
                    <div class="summary-stats">
                        <div class="summary-row">
                            <span class="summary-label">Spent Today</span>
                            <span class="summary-value negative" id="summary-spent">$0</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Earned Today</span>
                            <span class="summary-value positive" id="summary-earned">$0</span>
                        </div>
                        <div class="summary-row summary-total">
                            <span class="summary-label">Net Profit</span>
                            <span class="summary-value" id="summary-net">$0</span>
                        </div>
                    </div>
                </div>

                <!-- What You Missed -->
                <div class="summary-section summary-missed" id="summary-missed-section" style="display: none;">
                    <h3>What You Missed</h3>
                    <div class="summary-missed-content">
                        <div class="missed-boats" id="summary-missed-boats"></div>
                        <div class="missed-rival" id="summary-rival-losses" style="display: none;">
                            <span class="rival-icon">üòà</span>
                            <span class="rival-text">Slick Rick stole <span id="summary-rival-count">0</span> boat(s)!</span>
                        </div>
                        <div class="missed-total">
                            <span class="summary-label">Potential Lost</span>
                            <span class="summary-value warning" id="summary-missed-value">$0</span>
                        </div>
                    </div>
                </div>

                <!-- Inventory Status -->
                <div class="summary-section summary-inventory" id="summary-inventory-section">
                    <h3>Inventory Status</h3>
                    <div class="summary-inventory-content">
                        <div class="summary-row">
                            <span class="summary-label">Stock</span>
                            <span class="summary-value" id="summary-stock">0 lbs</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Freshness</span>
                            <span class="summary-value" id="summary-stock-freshness">100%</span>
                        </div>
                    </div>
                </div>

                <!-- Rank Up Section (shown when tier increases) -->
                <div class="summary-section summary-rankup" id="summary-rankup-section" style="display: none;">
                    <div class="rankup-content">
                        <span class="rankup-icon" id="rankup-icon">üéñÔ∏è</span>
                        <h3>New License Issued!</h3>
                        <p class="rankup-tier" id="rankup-tier">Local Regular</p>
                        <p class="rankup-flavor" id="rankup-flavor">The captains are starting to remember you.</p>
                    </div>
                </div>

                <!-- Tomorrow's Forecast -->
                <div class="summary-section summary-forecast">
                    <h3>Tomorrow's Forecast</h3>
                    <div class="summary-forecast-content">
                        <div class="summary-row">
                            <span class="summary-label">Weather</span>
                            <span class="summary-value" id="summary-weather">Sunny</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Market</span>
                            <span class="summary-value" id="summary-market">Stable</span>
                        </div>
                    </div>
                </div>

                <!-- Total Cash -->
                <div class="summary-row summary-cash">
                    <span class="summary-label">Total Cash</span>
                    <span class="summary-value" id="summary-total-cash">$5,000</span>
                </div>

                <button class="btn btn-large btn-ceremony" id="summary-continue">Start Day <span id="summary-next-day">2</span></button>
            </div>
        </div>
    </div>


    <script src="js/main.js"></script>
</body>
</html>
